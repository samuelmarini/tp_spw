
<!DOCTYPE html>

<html lang="English">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Useful Tools &#8212; TP-SPW 1. documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/smilei_theme.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Handout" href="handout.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
                <li class="outer">
                    <a href="introduction.html#observations-of-surface-plasma-waves-spw-using-the-particle-in-cell-pic-code-smilei">Observations of surface plasma waves (SPW) using the particle-in-cell (PIC) code SMILEI</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="#setting-your-workspace">Setting your workspace</a>
                </li>
                <li class="outer">
                    <a href="#a-1-download-and-install-the-pic-code-smilei">A.1- Download and install the PIC code Smilei</a>
                </li>
                <li class="outer">
                    <a href="#a-2-prepare-your-simulation">A.2- Prepare your simulation</a>
                </li>
                <li class="outer">
                    <a href="#a-3-run-your-simulation">A.3- Run your simulation</a>
                </li>
                <li class="outer">
                    <a href="#a-4-postprocess-your-simulation-results">A.4- Postprocess your simulation results</a>
                </li>
                <li class="outer">
                    <a href="#a-5-command-line-cheatsheet">A.5- Command line cheatsheet</a>
                </li>
                <li class="outer">
                    <a href="#postprocessing">Postprocessing</a>
                </li>
                <li class="outer">
                    <a href="#b-1-compilation-of-happi-library">B.1- Compilation of happi library</a>
                </li>
                <li class="outer">
                    <a href="#b-2-open-a-simulation">B.2- Open a simulation</a>
                </li>
                <li class="outer">
                    <a href="#b-3-plot-diagnostics">B.3- Plot diagnostics</a>
                </li>
                <li class="outer">
                    <a href="#b-4-visualize-multiple-timesteps">B.4- Visualize multiple timesteps</a>
                </li>
                <li class="outer">
                    <a href="#b-5-modify-elements-of-the-plot">B.5- Modify elements of the plot</a>
                </li>
                <li class="outer">
                    <a href="#b-6-plot-multiple-lines">B.6- Plot multiple lines</a>
                </li>
                <li class="outer">
                    <a href="#b-7-export-the-data">B.7- Export the data</a>
                </li>
        </ul>
        <hr />
        <ul>
                <li class="outer">
                    <a href="handout.html#prelude">Prelude</a>
                </li>
                <li class="outer">
                    <a href="handout.html#introduction-to-surface-plasma-waves">0.1- Introduction to Surface Plasma Waves</a>
                </li>
                <li class="outer">
                    <a href="handout.html#surface-plasma-waves-dispersion-relation">0.2- Surface Plasma Waves dispersion relation</a>
                </li>
                <li class="outer">
                    <a href="handout.html#physical-units-normalization">0.3- Physical units normalization</a>
                </li>
                <li class="outer">
                    <a href="handout.html#simulation-virtual-workspace">0.4- Simulation virtual workspace</a>
                </li>
                <li class="outer">
                    <a href=""></a>
                </li>
                <li class="outer">
                    <a href="handout.html#simulation-general-setup">0.5- Simulation general setup</a>
                </li>
                <li class="outer">
                    <a href="handout.html#simulation-input-namelist">0.6- Simulation input namelist</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-pulse">Laser Pulse</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-pulse-propagating-in-vacuum">1.1- Laser pulse propagating in vacuum</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-plasma-interaction">Laser-plasma interaction</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-pulse-interacting-with-a-flat-target">2.1- Laser pulse interacting with a flat target</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-pulse-interacting-with-a-sinusoidal-target">2.2- Laser pulse interacting with a sinusoidal target</a>
                </li>
                <li class="outer">
                    <a href="handout.html#laser-pulse-interacting-with-a-optimized-target">2.3- Laser pulse interacting with a optimized target</a>
                </li>
                <li class="outer">
                    <a href="handout.html#references">References</a>
                </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Useful Tools</a></div>
                <ul>
<li><a class="reference internal" href="#">Useful Tools</a><ul>
<li><a class="reference internal" href="#setting-your-workspace">Setting your workspace</a></li>
<li><a class="reference internal" href="#a-1-download-and-install-the-pic-code-smilei">A.1- Download and install the PIC code Smilei</a></li>
<li><a class="reference internal" href="#a-2-prepare-your-simulation">A.2- Prepare your simulation</a></li>
<li><a class="reference internal" href="#a-3-run-your-simulation">A.3- Run your simulation</a></li>
<li><a class="reference internal" href="#a-4-postprocess-your-simulation-results">A.4- Postprocess your simulation results</a></li>
<li><a class="reference internal" href="#a-5-command-line-cheatsheet">A.5- Command line cheatsheet</a></li>
<li><a class="reference internal" href="#postprocessing">Postprocessing</a></li>
<li><a class="reference internal" href="#b-1-compilation-of-happi-library">B.1- Compilation of happi library</a></li>
<li><a class="reference internal" href="#b-2-open-a-simulation">B.2- Open a simulation</a></li>
<li><a class="reference internal" href="#b-3-plot-diagnostics">B.3- Plot diagnostics</a></li>
<li><a class="reference internal" href="#b-4-visualize-multiple-timesteps">B.4- Visualize multiple timesteps</a></li>
<li><a class="reference internal" href="#b-5-modify-elements-of-the-plot">B.5- Modify elements of the plot</a></li>
<li><a class="reference internal" href="#b-6-plot-multiple-lines">B.6- Plot multiple lines</a></li>
<li><a class="reference internal" href="#b-7-export-the-data">B.7- Export the data</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo.svg" alt="Logo" />
            </a>
        </div>
        <div class="menu"
            id="menu_Introduction"
            
        >
            <div id="menuButton_Introduction" class="menuButton"
                 onmouseenter="prepareMenu('menu_Introduction')"
                 onmousedown="event.preventDefault()"
            >
                <a href="introduction.html">
                    <span>Introduction</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Introduction',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="introduction.html#observations-of-surface-plasma-waves-spw-using-the-particle-in-cell-pic-code-smilei">Observations of surface plasma waves (SPW) using the particle-in-cell (PIC) code SMILEI</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Useful Tools"
            
        >
            <div id="menuButton_Useful Tools" class="menuButton"
                 onmouseenter="prepareMenu('menu_Useful Tools')"
                 onmousedown="event.preventDefault()"
            >
                <a href="#">
                    <span>Useful Tools</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Useful Tools',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="#setting-your-workspace">Setting your workspace</a>
                        </li>
                        <li class="outer">
                            <a href="#a-1-download-and-install-the-pic-code-smilei">A.1- Download and install the PIC code Smilei</a>
                        </li>
                        <li class="outer">
                            <a href="#a-2-prepare-your-simulation">A.2- Prepare your simulation</a>
                        </li>
                        <li class="outer">
                            <a href="#a-3-run-your-simulation">A.3- Run your simulation</a>
                        </li>
                        <li class="outer">
                            <a href="#a-4-postprocess-your-simulation-results">A.4- Postprocess your simulation results</a>
                        </li>
                        <li class="outer">
                            <a href="#a-5-command-line-cheatsheet">A.5- Command line cheatsheet</a>
                        </li>
                        <li class="outer">
                            <a href="#postprocessing">Postprocessing</a>
                        </li>
                        <li class="outer">
                            <a href="#b-1-compilation-of-happi-library">B.1- Compilation of happi library</a>
                        </li>
                        <li class="outer">
                            <a href="#b-2-open-a-simulation">B.2- Open a simulation</a>
                        </li>
                        <li class="outer">
                            <a href="#b-3-plot-diagnostics">B.3- Plot diagnostics</a>
                        </li>
                        <li class="outer">
                            <a href="#b-4-visualize-multiple-timesteps">B.4- Visualize multiple timesteps</a>
                        </li>
                        <li class="outer">
                            <a href="#b-5-modify-elements-of-the-plot">B.5- Modify elements of the plot</a>
                        </li>
                        <li class="outer">
                            <a href="#b-6-plot-multiple-lines">B.6- Plot multiple lines</a>
                        </li>
                        <li class="outer">
                            <a href="#b-7-export-the-data">B.7- Export the data</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Handout"
            
        >
            <div id="menuButton_Handout" class="menuButton"
                 onmouseenter="prepareMenu('menu_Handout')"
                 onmousedown="event.preventDefault()"
            >
                <a href="handout.html">
                    <span>Handout</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Handout',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="handout.html#prelude">Prelude</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#introduction-to-surface-plasma-waves">0.1- Introduction to Surface Plasma Waves</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#surface-plasma-waves-dispersion-relation">0.2- Surface Plasma Waves dispersion relation</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#physical-units-normalization">0.3- Physical units normalization</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#simulation-virtual-workspace">0.4- Simulation virtual workspace</a>
                        </li>
                        <li class="outer">
                            <a href=""></a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#simulation-general-setup">0.5- Simulation general setup</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#simulation-input-namelist">0.6- Simulation input namelist</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-pulse">Laser Pulse</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-pulse-propagating-in-vacuum">1.1- Laser pulse propagating in vacuum</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-plasma-interaction">Laser-plasma interaction</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-pulse-interacting-with-a-flat-target">2.1- Laser pulse interacting with a flat target</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-pulse-interacting-with-a-sinusoidal-target">2.2- Laser pulse interacting with a sinusoidal target</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#laser-pulse-interacting-with-a-optimized-target">2.3- Laser pulse interacting with a optimized target</a>
                        </li>
                        <li class="outer">
                            <a href="handout.html#references">References</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="10" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="10" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="useful-tools">
<span id="usefultools"></span><h1>Useful Tools<a class="headerlink" href="#useful-tools" title="Permalink to this heading">¶</a></h1>
<section id="setting-your-workspace">
<h2>Setting your workspace<a class="headerlink" href="#setting-your-workspace" title="Permalink to this heading">¶</a></h2>
</section>
<section id="a-1-download-and-install-the-pic-code-smilei">
<h2>A.1- Download and install the PIC code Smilei<a class="headerlink" href="#a-1-download-and-install-the-pic-code-smilei" title="Permalink to this heading">¶</a></h2>
<p>Before you start your practical work,
you must install the PIC code Smile on your computer.
To do this, go to the Smilei webpage <a class="reference external" href="https://smileipic.github.io/Smilei/Use/installation.html">https://smileipic.github.io/Smilei/Use/installation.html</a>, select your operating system
and carefully follow all the instructions.
If you have already installed the PIC code Smilei, skip this part.
At the end of this step, you must have the files called <code class="docutils literal notranslate"><span class="pre">smilei</span></code> and <code class="docutils literal notranslate"><span class="pre">smilei_test</span></code> in the folder you intalled Smilei.</p>
<p>Besides install the PIC code <cite>Smilei</cite>, install postprocessing library <cite>happi</cite> and keep the location of your executable filles <cite>Smilei</cite> and <cite>happi</cite>
in mind. (<cite>e.g.</cite>  <code class="docutils literal notranslate"><span class="pre">path/to/executable</span></code>)</p>
</section>
<section id="a-2-prepare-your-simulation">
<h2>A.2- Prepare your simulation<a class="headerlink" href="#a-2-prepare-your-simulation" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Enter your working space (folder where you will place your simulations)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> path/to/workdir
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">path/to/workdir</span></code> is the path to your workdir.
- In your workdir, create a new simulation folder, for example a folder called <code class="docutils literal notranslate"><span class="pre">sim1</span></code>, where you will run your simulation 1:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir sim1
<span class="nb">cd</span> sim1
</pre></div>
</div>
<p>Each time you do it, choose a convenient name of the folder to
remember which simulation it contains. In order to avoid overwriting data, it is recommended to create
a new simulation folder for each simulation.</p>
<ul class="simple">
<li><p>Inside the simulation folder, create a symbolic link to the Smilei executables. The comand line to create a symbolic link to Smilei is</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ln -s path/to/executable/smilei
ln -s path/to/executable/smilei_test
</pre></div>
</div>
<p>As antecipated <code class="docutils literal notranslate"><span class="pre">path/to/executable</span></code> is the path to your executable filles. So you need to insert the actual path where your files <code class="docutils literal notranslate"><span class="pre">smilei</span></code>
and <code class="docutils literal notranslate"><span class="pre">smilei_test</span></code> are.</p>
<ul class="simple">
<li><p>Inside the simulation folder, you also need a file to submit your simulation job to the job scheduler, <cite>e.g.`</cite> <code class="docutils literal notranslate"><span class="pre">submission_script.sh</span></code>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">NP</span><span class="o">=</span><span class="nv">$1</span>  <span class="c1"># argument (nb of MPI processes)</span>
<span class="nv">FTR</span><span class="o">=</span><span class="nv">$2</span> <span class="c1"># argument (file to read = .py file)</span>
<span class="nv">DIAG</span><span class="o">=</span><span class="nv">$3</span> <span class="c1"># argument (put -d if you want the script to run python diags)</span>

<span class="nv">PS</span><span class="o">=</span>/path/to/Smilei_Folder <span class="c1">#you must change this path according.</span>
<span class="c1"># input/results/smilei(.exe) directories</span>
<span class="nv">INPDIR</span><span class="o">=</span><span class="nv">$PS</span>/Input <span class="c1">#you must create the folders Input and Results before</span>
<span class="nv">RESDIR</span><span class="o">=</span><span class="nv">$PS</span>/Results
<span class="nv">SMIDIR</span><span class="o">=</span><span class="nv">$PS</span>/Smilei

<span class="nv">DIAGDIR</span><span class="o">=</span><span class="nv">$PS</span>/Smilei/smilei-laser_from_file/scripts/TPUPMC <span class="c1"># script for the diagnostics</span>

<span class="c1"># preparing the code</span>
<span class="nv">START</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
rm -rf <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
mkdir -p <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
cp <span class="nv">$INPDIR</span>/<span class="nv">$FTR</span>.py <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
<span class="nb">cd</span> <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
<span class="nb">pwd</span>

<span class="c1"># running the code</span>
<span class="nv">DYLD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$HDF5_ROOT_DIR</span>/lib mpirun -np <span class="nv">$NP</span> <span class="nv">$SMIDIR</span>/smilei <span class="nv">$FTR</span>.py
<span class="c1">#mpirun -np $NP $SMIDIR/Smilei $FTR.py</span>

<span class="nb">cd</span> <span class="nv">$START</span>
<span class="c1"># running the diagnostics</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$DIAG</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;-d&quot;</span> <span class="o">]</span>
   <span class="k">then</span>
      <span class="nv">$DIAGDIR</span>/SmileiQt.py <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$DIAG</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;-davg&quot;</span> <span class="o">]</span>
   <span class="k">then</span>
      <span class="nv">$DIAGDIR</span>/SmileiQt_avg.py <span class="nv">$RESDIR</span>/<span class="nv">$FTR</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>Check the script <code class="docutils literal notranslate"><span class="pre">submission_script.sh</span></code> above and modify accoding.</p>
<p>Finally, you need your input file with instructrions for <cite>Smilei</cite>. In this pratical work, we will call it <code class="docutils literal notranslate"><span class="pre">InputNamelist.py</span></code>. All instructions to run a simulation on SPW is in this fille.</p>
</section>
<section id="a-3-run-your-simulation">
<h2>A.3- Run your simulation<a class="headerlink" href="#a-3-run-your-simulation" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Check if you have all the required files (executables, submission script, input namelist) through the command:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
<p>in your prompt. In this present case, you must have the symbolic links <code class="docutils literal notranslate"><span class="pre">smilei</span></code> and <code class="docutils literal notranslate"><span class="pre">smilei_test</span></code> , the submission file <code class="docutils literal notranslate"><span class="pre">submission_script.sh</span></code> and the Input namelist <code class="docutils literal notranslate"><span class="pre">InputNamelist.py</span></code>.</p>
<ul class="simple">
<li><p>Now you check your namelist does not contain syntax errors, use the <code class="docutils literal notranslate"><span class="pre">smilei_test</span></code> executable on the namelist (you will need to load the same libraries used for the code compilation): <code class="docutils literal notranslate"><span class="pre">./smilei_test</span> <span class="pre">InputNamelist.py</span></code>. If you see the line <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">TEST</span> <span class="pre">MODE</span></code>, the namelist does not contain syntax errors and can be run.</p></li>
<li><p>Launch your simulation job:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run_new.sh <span class="m">2</span> InputNamelist
</pre></div>
</div>
</section>
<section id="a-4-postprocess-your-simulation-results">
<h2>A.4- Postprocess your simulation results<a class="headerlink" href="#a-4-postprocess-your-simulation-results" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Open <code class="docutils literal notranslate"><span class="pre">IPython</span></code> (before, you will need to load the Python modules and define variables like how you did to compile the code, and be sure you have compiled <code class="docutils literal notranslate"><span class="pre">happi</span></code>):</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ipython
</pre></div>
</div>
<ul class="simple">
<li><p>Import the libraries you need:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>import happi
import numpy as np
import matplotlib.pyplot as plt
</pre></div>
</div>
<p>The output files have the extension <code class="docutils literal notranslate"><span class="pre">.h5</span></code> and can be opened  with the postprocessing library <code class="docutils literal notranslate"><span class="pre">happi</span></code>. You will need also the
file <code class="docutils literal notranslate"><span class="pre">smilei.py</span></code>, generated at the start of your simulation.</p>
<ul class="simple">
<li><p>Open your simulation:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">S</span> <span class="o">=</span> happi.Open<span class="o">(</span><span class="s2">&quot;path/to/my/results&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>again, <code class="docutils literal notranslate"><span class="pre">&quot;path/to/my/results&quot;</span></code> is an example, you need to put the path of your simulation.
If you use simply <code class="docutils literal notranslate"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">happi.Open()</span></code>, the library <code class="docutils literal notranslate"><span class="pre">happi</span></code> open the results inside the current working directory.</p>
<ul class="simple">
<li><p>Now you can use the commands in the section postprocessing.</p></li>
</ul>
</section>
<section id="a-5-command-line-cheatsheet">
<h2>A.5- Command line cheatsheet<a class="headerlink" href="#a-5-command-line-cheatsheet" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pwd</span></code>: shows the path of the current working directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">path</span></code>: go to <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ls</span></code>: shows the content of the current directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">path</span></code>: shows the content in <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rm</span> <span class="pre">file</span></code>: removes <code class="docutils literal notranslate"><span class="pre">file</span></code>. To remove a folder, you will need an additional flag: <code class="docutils literal notranslate"><span class="pre">rm</span> <span class="pre">-r</span> <span class="pre">folder</span></code> (be careful).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">source_file</span> <span class="pre">destination_path</span></code>: copies <code class="docutils literal notranslate"><span class="pre">source_file</span></code> to the <code class="docutils literal notranslate"><span class="pre">destination_path</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scp</span> <span class="pre">source_file</span> <span class="pre">destination_path</span></code> : same as <code class="docutils literal notranslate"><span class="pre">cp</span></code>, but you can also transfer folders and files to a different machine, e.g. from the cluster to your computer and vice versa. You have to provide your username, the server address and your password, e.g. <code class="docutils literal notranslate"><span class="pre">scp</span> <span class="pre">source_file</span> <span class="pre">username&#64;server:/destination_path/</span></code>. This command can be used to transfer output files from the cluster to your computer for later postprocessing if so you prefer (of course larger data files will need more time to transfer).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mv</span> <span class="pre">source</span> <span class="pre">destination</span></code>: move <code class="docutils literal notranslate"><span class="pre">source</span></code> (can be a file or directory) to a <code class="docutils literal notranslate"><span class="pre">destination</span></code>. If the <code class="docutils literal notranslate"><span class="pre">destination</span></code> does not specify a path, the command renames <code class="docutils literal notranslate"><span class="pre">source</span></code> with the name</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">destination</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ipython</span></code>: opens <code class="docutils literal notranslate"><span class="pre">Ipython</span></code>, where also the previous commands can be used. To run a Python script inside this interface, use <code class="docutils literal notranslate"><span class="pre">%run</span> <span class="pre">script_name.py</span></code>.</p></li>
</ul>
</section>
<section id="postprocessing">
<span id="id1"></span><h2>Postprocessing<a class="headerlink" href="#postprocessing" title="Permalink to this heading">¶</a></h2>
<p>A fundamental part of working with simulation codes is the
postprocessing of the results. Smilei includes an entire <code class="docutils literal notranslate"><span class="pre">Python</span></code> library
for postprocessing.
However, to plot your first results and make quantitative evaluations
you do not need to be an expert of <code class="docutils literal notranslate"><span class="pre">Python</span></code>.</p>
<p>For your convenience and quick reference, here we include only the commands
you will need for this practical. Do not hesitate to copy and paste
the following commands in <code class="docutils literal notranslate"><span class="pre">IPython</span></code> and adapt them to the problem you are solving.</p>
<p>Remember that the results are in normalized units.
The library <code class="docutils literal notranslate"><span class="pre">happi</span></code> also allows to convert to SI units, but this will not be taught in this practical
(details in the <a class="reference external" href="https://smileipic.github.io/Smilei/Use/post-processing.html">documentation</a>).</p>
</section>
<section id="b-1-compilation-of-happi-library">
<h2>B.1- Compilation of happi library<a class="headerlink" href="#b-1-compilation-of-happi-library" title="Permalink to this heading">¶</a></h2>
<p>It is sufficient to use the command <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">happi</span></code> in the code folder
(after you have loaded the Python modules, see the file <code class="docutils literal notranslate"><span class="pre">ClusterEnvironment.pdf</span></code>).
Then, to analyze the results of your simulation, open the <code class="docutils literal notranslate"><span class="pre">IPython</span></code> interface
(just use the command <code class="docutils literal notranslate"><span class="pre">ipython</span></code> in the command line terminal).</p>
</section>
<section id="b-2-open-a-simulation">
<h2>B.2- Open a simulation<a class="headerlink" href="#b-2-open-a-simulation" title="Permalink to this heading">¶</a></h2>
<p>To import the library <code class="docutils literal notranslate"><span class="pre">happi</span></code> in <code class="docutils literal notranslate"><span class="pre">IPython</span></code> and open a simulation in the folder, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span><span class="p">;</span> <span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;path/to/simulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this specific example the folder’s path is called for example <code class="docutils literal notranslate"><span class="pre">&quot;path/to/simulation&quot;</span></code>
(use the path of your simulation instead!).</p>
<p>The last command will create an object called <code class="docutils literal notranslate"><span class="pre">S</span></code>, our simulation,
which contains all the necessary data, taken from the input namelist and from the
output files.</p>
<p>You can easily access parameters from the input namelist, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">namelist</span><span class="o">.</span><span class="n">Lx</span>
<span class="n">S</span><span class="o">.</span><span class="n">namelist</span><span class="o">.</span><span class="n">dx</span>
</pre></div>
</div>
<p>In general, if you tap <code class="docutils literal notranslate"><span class="pre">S.</span></code> or add the name of the blocks and then use the tab key,
you will see the available blocks and variables.</p>
</section>
<section id="b-3-plot-diagnostics">
<h2>B.3- Plot diagnostics<a class="headerlink" href="#b-3-plot-diagnostics" title="Permalink to this heading">¶</a></h2>
<p>To open a specific diagnostic, like the <code class="docutils literal notranslate"><span class="pre">Probe1</span></code> defined in the namelist,
and plot the longitudinal electric field <code class="docutils literal notranslate"><span class="pre">Ex</span></code> contained in that diagnostic, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Other physical fields defined on the grid that you can plot are for example <code class="docutils literal notranslate"><span class="pre">Ey</span></code>
(the electric field component in the <cite>y</cite> direction),
<code class="docutils literal notranslate"><span class="pre">Rho</span></code> (the charge density). Remember that you can also specify operations
on the fields, like <code class="docutils literal notranslate"><span class="pre">Ey*Ey+Ex*Ex</span></code>, when you declare your variable.</p>
<p>By default, the last command will only plot the requested field obtained
in the last simulation output available for that diagnostic.
You may instead be interested in a specific iteration of the simulation (in code units),
like iteration <cite>1200</cite>. To plot only that timestep, just specify it inside the diagnostic block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Remember that this timestep corresponds to physical time <code class="docutils literal notranslate"><span class="pre">1200*dt</span></code>, where <code class="docutils literal notranslate"><span class="pre">dt</span></code>
is the simulation timestep, which can be found with <code class="docutils literal notranslate"><span class="pre">dt=S.namelist.Main.timestep</span></code>.</p>
<p>To know which iterations are available in your diagnostic, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getAvailableTimesteps</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="b-4-visualize-multiple-timesteps">
<h2>B.4- Visualize multiple timesteps<a class="headerlink" href="#b-4-visualize-multiple-timesteps" title="Permalink to this heading">¶</a></h2>
<p>Normally you have a sequence of outputs, so you may want to see an animation
of the outputs or to be able to slide between the saved timesteps.
It is possible to do it with these commands respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">animate</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">slide</span><span class="p">()</span>
</pre></div>
</div>
<p>In the last case, just slide with the horizontal bar to see the evolution of the plotted quantity at
different iterations.</p>
</section>
<section id="b-5-modify-elements-of-the-plot">
<h2>B.5- Modify elements of the plot<a class="headerlink" href="#b-5-modify-elements-of-the-plot" title="Permalink to this heading">¶</a></h2>
<p>Like in Python, you may be interested into specifying the figure number,
or change the colormap, or specifying a maximum or minimum value plotted.
You can include the same corresponding keywords inside the plot/animate/slide command.
As an example where all these elements are specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;seismic&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="b-6-plot-multiple-lines">
<h2>B.6- Plot multiple lines<a class="headerlink" href="#b-6-plot-multiple-lines" title="Permalink to this heading">¶</a></h2>
<p>You may be interested in visualizing multiple curves in the same plot window.
Then the command <code class="docutils literal notranslate"><span class="pre">happi.multiPlot</span></code> is what you need.</p>
<p>For example, if you want to plot two quantities from the same simulation,
scaling them through multiplying factors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;path/to/simulation&quot;</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;0.1*Ex&quot;</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;E&quot;</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;-10.*Rho&quot;</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;charge density&quot;</span><span class="p">)</span>
<span class="n">happi</span><span class="o">.</span><span class="n">multiPlot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The previous example draws two curves, but you can use multiPlot to plot more curves.</p>
<p>Note that you can plot also different timesteps from the same simulation with the same procedure.
Similarly, you can plot two quantities from two or more simulations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;path/to/simulation1&quot;</span><span class="p">)</span>
<span class="n">Ex1</span> <span class="o">=</span> <span class="n">S1</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span><span class="n">timesteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;path/to/simulation2&quot;</span><span class="p">)</span>
<span class="n">Ex2</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe0</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span><span class="n">timesteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">happi</span><span class="o">.</span><span class="n">multiPlot</span><span class="p">(</span><span class="n">Ex1</span><span class="p">,</span><span class="n">Ex2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="b-7-export-the-data">
<h2>B.7- Export the data<a class="headerlink" href="#b-7-export-the-data" title="Permalink to this heading">¶</a></h2>
<p>Those shown above are all the <code class="docutils literal notranslate"><span class="pre">happi</span></code> commands you may need for this practical.
If you prefer instead to analyze your results with <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays in Python,
you can easily export your diagnostic to a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;path/to/simulation&quot;</span><span class="p">)</span>
<span class="n">myArrayVariable</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>
<span class="n">myArrayVariable</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Probe</span><span class="o">.</span><span class="n">Probe1</span><span class="p">(</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>
<span class="n">myArrayVariable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">myArrayVariable</span><span class="p">)</span>
</pre></div>
</div>
<p>In case you want to export the data to a text file <code class="docutils literal notranslate"><span class="pre">.txt</span></code> and read it with
another language, you can write this array on a text file using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;file_name.txt&quot;</span><span class="p">,</span> <span class="n">myArrayVariable</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Mar 25, 2023
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      </div>
      
      <div>
      <a href="_sources/useful_tools.rst.txt"
          rel="nofollow">Page source</a></li>
      </div>
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            e.preventDefault();
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
                document.documentElement.style.overflow = "hidden";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
                document.documentElement.style.overflow = "";
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>